<div class="primary-nav-container">
  <h1><%= @sensor.name %></h1>
  <%= link_to 'Edit', edit_sensor_path(@sensor), class: 'btn' %>
  <%= link_to 'Year', sensor_path(@sensor, timespan: 'year'), class: 'btn' %>
  <%= link_to 'Week', sensor_path(@sensor, timespan: 'week'), class: 'btn' %>
  <%= link_to 'Day', sensor_path(@sensor, timespan: 'day'), class: 'btn' %>
</div>
<div class="chart-container-full">
  <% if params[:timespan].nil? || params[:timespan] == 'day' %>
    <%= area_chart @sensor.data_points.group_by_hour(:logged_at, range: 1.days.ago.midnight..1.hour.ago).maximum(:value) %>
  <% elsif params[:timespan] == 'week' %>
    <%= area_chart @sensor.data_points.group_by_hour(:logged_at, range: 7.days.ago.midnight..1.hour.ago).maximum(:value) %>
  <% elsif params[:timespan] == 'month' %>
    <%= area_chart @sensor.data_points.group_by_day(:logged_at, range: 31.days.ago.midnight..1.hour.ago).maximum(:value) %>
  <% elsif params[:timespan] == 'year' %>
    <%= area_chart @sensor.data_points.group_by_day(:logged_at, range: 365.days.ago.midnight..1.hour.ago).maximum(:value) %>
  <% end %>
</div>

<ul class="horizontal-grid">
  <li class="sensor-readout-horizontal">
    <h3>Average</h3>
    <p class="value"><%= @sensor.data_points.average(:value).to_i %><%= @sensor.units %></p>
  </li>
  <li class="sensor-readout-horizontal">
    <h3>Maximum</h3>
    <p class="value"><%= @sensor.data_points.maximum(:value) %><%= @sensor.units %></p>
  </li>
  <li class="sensor-readout-horizontal">
    <h3>Minimum</h3>
    <p class="value"><%= @sensor.data_points.minimum(:value) %><%= @sensor.units %></p>
  </li>
</ul>

<% unless @sensor.events.empty? %>
  <h2>Events</h2>
  <table>
    <% @sensor.events.each do |event| %>
      <tr>
        <td><%= event.created_at %></td>
        <td><%= event.event_type %></td>
      </tr>
    <% end %>
  </table>
<% end %>
<p></p>

